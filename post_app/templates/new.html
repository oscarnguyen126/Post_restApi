<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Post Create</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
      crossorigin="anonymous"
    />
    <script
      src="https://code.jquery.com/jquery-3.7.1.js"
      integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4="
      crossorigin="anonymous"
    ></script>
    <script src="/static/js/request.js" type="text/javascript"></script>
  </head>

  <body>
    <div
      class="container-md shadow p-3 mb-5 bg-body rounded position-absolute top-50 start-50 translate-middle"
    >
      <p class="fw-bold">New Post</p>
      <form id="form" method="post" class="d-flex flex-column">
        {% csrf_token %}
        <div class="d-flex flex-row justify-content-between">
          <div class="col-6">
            <div>
              <label for="code">Code</label> <br />
              <input
                name="code"
                type="text"
                class="form-control"
                placeholder="name"
                id="code"
              />
            </div>

            <div>
              <label for="name">Name</label> <br />
              <input
                name="name"
                type="text"
                class="form-control"
                placeholder="name"
                id="name"
              />
            </div>

            <div>
              <label for="meta_keyword">Meta keyword</label><br />
              <input
                type="text"
                class="form-control"
                placeholder="meta keyword"
                id="meta_keyword"
                name="meta_keyword"
              />
            </div>
          </div>
          <div class="col-6">
            <div>
              <label for="title">Title</label><br />
              <input
                type="text"
                class="form-control"
                placeholder="title"
                id="title"
                name="title"
              />
            </div>

            <div>
              <label for="keyword">Keyword</label><br />
              <input
                type="text"
                class="form-control"
                placeholder="keyword"
                id="keyword"
                name="keyword"
              />
            </div>
          </div>
        </div>

        <div>
          <label for="description">Description</label><br />
          <input
            type="text"
            class="form-control"
            placeholder="description"
            id="description"
            name="description"
          />
        </div>

        <div>
          <label for="types">Types</label>
          <select
            class="form-select"
            aria-label="Default select example"
            name="types"
            id="types"
            name="types"
          ></select>
        </div>

        <div>
          <label for="short_content">Short content</label>
          <textarea
            class="form-control"
            placeholder="Short content"
            id="short_content"
            name="short_content"
          ></textarea>
        </div>

        <div>
          <label for="content">Content</label>
          <textarea
            class="form-control"
            placeholder="content"
            id="content"
            name="content"
          ></textarea>
        </div>

        <div class="form-group">
          <center>
            <button type="submit">Submit</button>
            <!-- <button type="button" class="btn btn-primary btn-sm">Save</button> -->
            <!-- <button type="button" class="btn btn-secondary btn-sm"> -->
            <!-- Cancel
            </button> -->
          </center>
        </div>
      </form>
    </div>
  </body>

  <script>
    get("/categories", function (data) {
      for (let item of data) {
        $("#types").append(
          `<option value="${item.uuid}">${item.name}</option>`
        );
      }
    });

    $("form").submit(function (e) {
      e.preventDefault();
      const formData = $("form").serializeArray();
      const payload = {};
      for (let item of formData) {
        payload[item.name] = item.value;
      }

      post("/posts/", payload, function (data) {
        // if status code = 201
        window.location.href = "/";
      });
    });
  </script>
</html>
